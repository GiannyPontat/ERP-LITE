<div class="app-container">
  <!-- Layout PrivÃ© (avec sidebar + toolbar) -->
  @if (showLayout) {
    <!-- Backdrop pour mobile -->
    @if (sidebarOpen && (isHandset$ | async)) {
      <div class="sidebar-backdrop" (click)="toggleSidebar()"></div>
    }

    <!-- Sidebar -->
    <app-sidebar
      [isOpen]="sidebarOpen || !(isHandset$ | async)"
      [companyName]="'mon entreprise'"
      [initials]="'ME'"
      (onClose)="closeSidebar()">
    </app-sidebar>

    <!-- Contenu principal avec toolbar -->
    <div class="main-wrapper" [class.sidebar-open]="!(isHandset$ | async)">
      <!-- Toolbar -->
      <mat-toolbar color="primary" class="toolbar">
        @if (isHandset$ | async) {
          <button
            type="button"
            aria-label="Toggle navigation"
            mat-icon-button
            (click)="toggleSidebar()">
            <mat-icon>menu</mat-icon>
          </button>
        }
        <span class="toolbar-title">{{ title }}</span>
        <span class="toolbar-spacer"></span>
        <button mat-icon-button [matMenuTriggerFor]="menu">
          <mat-icon>account_circle</mat-icon>
        </button>
        <mat-menu #menu="matMenu">
          <button mat-menu-item>
            <mat-icon>settings</mat-icon>
            <span>{{ 'parametres' | translate | capitalize }}</span>
          </button>
          <button mat-menu-item (click)="logout()">
            <mat-icon>logout</mat-icon>
            <span>{{ 'deconnexion' | translate | capitalize }}</span>
          </button>
        </mat-menu>
      </mat-toolbar>

      <!-- Contenu -->
      <main class="main-content">
        <router-outlet></router-outlet>
      </main>
    </div>
  }

  <!-- Layout Public (login/register - sans sidebar/toolbar) -->
  @else {
    <div class="public-layout">
      <router-outlet></router-outlet>
    </div>
  }
</div>
